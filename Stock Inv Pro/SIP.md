Stock Investor Pro (SIP) is available for subscription from aaii.com. Its database provides fundamental analysis metrics for over 6650 stocks. The data can be downloaded on a daily basis to keep up-to-date with the current market activity. The software has a fairly intuitive interface for either using pre-built screens (for popular stock screens developed by leading investment gurus) or creating your own screens. The view option allows one to limit the metrics visible on the first tab of the stock sub-universe (as decided by the screen). The custom field option allows one to create new variables and it will create those variables. So, combining all of these three, one should be able to create new custom variables and screens, view the results for appropriateness, and apply them to find that subuniverse of stocks that match those criteria. 

I have been trying to implement some screens recommended in O'Shaunessy's 2012 book: "What works on the Wall Street", 4th edition. Some of his screens have been pre-built in SIP; but they were based on the third edition of the book (published in 2006), and no updates have been done since then. For his 2012 edition, he back-tested his screens for stocks over the period of 1929 to 2009 and may be considered to be statistically more sound. It is interesting that his own consulting group does not seem to be following many of the top-performing screens in the book. I sent him an email on that in May 2018 and am waiting for a response to the query. Meanwhile, I am attempting to create those screens on SIP. 

Here are some of the challenges I faced in achieving this:
1. The SIP data has many NA in the columns. O'Shaunessy recommends assigning percentile ranks of 50 for such entries. I contacted AAII and they helped me with an example for the use of IIF and IF constructs. I was able to create a custome variable for this function. 
2. Many of the ratios in SIP are inverse of what O'Shuanessy uses. So, percentile ranks built on them would have to be recalculated as 100- the SIP value, to (approximately) meet the need.
3. Not all needed percentile ranks are provided. Besides the terminology that O'Shaunessy uses does not match with SIP's standardized terminology. So, some amount of guessing is involved in  both identifying an appropriate available measure and also developing new custome measures. 
4. Once new custome screens are built, we need to test them for real data over a period of 3 or more months, to confirm that indeed each individual custome screen matches with O'Shaunessy's screen criteria. Note that many of the screens I plan to develop perform better than the universe they are compared with, typically after 3 years, as per o'Shaunessy. So, this testintg has to be continued for atleast 3 years to be absolutely sure. For this forward-testing, I will use Investopedia stock games. 

This is being updated on 7/28/18. AAII had an article on Pat O'Shaunessy's Millenial Investor Strategy published around June 2013. It cannot be fully implemented in SIP (Stock investor Pro). So, a prescreen is used to define a sub-universe of stocks (in the current case, it reduced from the original ~16K stocks to about 1.4K). I used the 'Copy Notebook' option in SIP to copy the columns in the view section (more below) and then pasted it in Excel. If you use the Export option in SIP, the result is only compatible with Excel 2 or earlier. You can still use it, but first the Excel option to edit an earlier option needs to be overridden. See Options --> Trust Center on how to handle that. The notebook copy option is better, as the paste is compatible with current Excel version. Save it as .xslx. You can then import into my R code included here. 

I set up the view to include all the relevant parameters, which in my case included, in addition, James O'Shaughnessy's value, accounting, and financial composites, as well as momentum screen, and my own fraud screen, as outlined in a [paper](http://web.nacva.com/JFIA/Issues/JFIA-2010-2_12.pdf). James O'Shaugnessy's financial composite was left out of his 4th edition book, but is available [here](http://www.whatworksonwallstreet.com/pdf/wwows_CS_14.pdf) to download. There are other case studies [here](http://www.whatworksonwallstreet.com/supplement.html).  I used this [paper](https://ageconsearch.umn.edu/bitstream/21152/1/sp06tr01.pdf) to calculate total accrual that is needed for the financial composite. All these are uploaded here. Patrick's prescreen and my view files for use on SIP will be uploaded here. I have uploaded my raw R code for now (until I get to create a knitR document), along with my Word and Excel documents.  

Some recent articles at OSAM website (O'Shaughnessy Asset Management) are interesting and useful. The article by Fairchild on erosion of book value due to the GAAP guidelines is corrected by estimation to evolve a fairer book value. Without that, one would be using an artifically low or negative book value, characterizing such companies as growth, and not value companies, thus improving the performance of growth funds at the expense of value funds. Here is the [article](http://www.osam.com/pdfs/research/44_Negative_Equity_Veiled_Value_and_the_Erosion_of_Price-to-Book-April-30-2018.pdf). I have estimated this enhanced book value in my calculations, though not used it in an organized manner in improving the value composite. Another article, entitled "Factors from Scratch" shows how annual rebalancing (38% turnover) is essential for realizing a good retuirn on their Value factor (cheapest quintile on PE ratio). Here is the [link](http://osam.com/pdfs/research/49_OSAM_Factors_From_Scratch_July2018.pdf). The turnover occurs when companies with P/E appreciation beyond the lowest quintile are sold and new ones with low P/E are bought at the end of the year. Momentum strategy invests in the top quintile of large cap stocks in the trailing six month momentum. This portfolio must be rebalanced annually, since the momentum strategy reverses itself on longer holding periods. Its initial excess return is through a divergence away from fair value. In value stocks, the excess return is generated through a convergence towards fair value - i.e., mispriced Value stocks becoming less mispriced. 
