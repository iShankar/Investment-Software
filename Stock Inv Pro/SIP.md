Stock Investor Pro (SIP) is available for subscription from aaii.com. Its database provides fundamental analysis metrics for over 6650 stocks. The data can be downloaded on a daily basis to keep up-to-date with the current market activity. The software has a fairly intuitive interface for either using pre-built screens (for popular stock screens developed by leading investment gurus) or creating your own screens. The view option allows one to limit the metrics visible on the first tab of the stock sub-universe (as decided by the screen). The custom field option allows one to create new variables and it will create those variables. So, combining all of these three, one should be able to create new custom variables and screens, view the results for appropriateness, and apply them to find that subuniverse of stocks that match those criteria. 

I have been trying to implement some screens recommended in O'Shaunessy's 2012 book: "What works on the Wall Street", 4th edition. Some of his screens have been pre-built in SIP; but they were based on the third edition of the book (published in 2006), and no updates have been done since then. For his 2012 edition, he back-tested his screens for stocks over the period of 1929 to 2009 and may be considered to be statistically more sound. It is interesting that his own consulting group does not seem to be following many of the top-performing screens in the book. I sent him an email on that in May 2018 and am waiting for a response to the query. Meanwhile, I am attempting to create those screens on SIP. 

Here are some of the challenges I faced in achieving this:
1. The SIP data has many NA in the columns. O'Shaunessy recommends assigning percentile ranks of 50 for such entries. I contacted AAII and they helped me with an example for the use of IIF and IF constructs. I was able to create a custome variable for this function. 
2. Many of the ratios in SIP are inverse of what O'Shuanessy uses. So, percentile ranks built on them would have to be recalculated as 100- the SIP value, to (approximately) meet the need.
3. Not all needed percentile ranks are provided. Besides the terminology that O'Shaunessy uses does not match with SIP's standardized terminology. So, some amount of guessing is involved in  both identifying an appropriate available measure and also developing new custome measures. 
4. Once new custome screens are built, we need to test them for real data over a period of 3 or more months, to confirm that indeed each individual custome screen matches with O'Shaunessy's screen criteria. Note that many of the screens I plan to develop perform better than the universe they are compared with, typically after 3 years, as per o'Shaunessy. So, this testintg has to be continued for atleast 3 years to be absolutely sure. For this forward-testing, I will use Investopedia stock games. 
